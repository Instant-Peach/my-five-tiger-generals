# 오호대장군 - 에픽/스토리 백로그

> 작성일: 2026-02-02
> 버전: 1.1.0 (SSOT 정합성 반영)
> 작성자: Max (Scrum Master)

---

## 백로그 범례

**스토리 포인트 (SP)**:
- 1 SP = 반나절 작업
- 2 SP = 하루 작업
- 3 SP = 이틀 작업
- 5 SP = 일주일 작업

**우선순위**:
- 🔴 Must Have (필수)
- 🟡 Should Have (중요)
- 🟢 Nice to Have (있으면 좋음)

---

## Phase 1: Local Demo

### Epic 0: 기술 검증 (Spike) 🔴 ⚡ NEW

> **목표**: 삼각형 좌표계 핵심 기술 검증
> **총 SP**: 3
> **기간**: 2-3일

#### Story 0.1: 삼각형 보드 Spike
```yaml
ID: P1-E0-S1
제목: 삼각형 보드 기술 검증
설명: Vite + Phaser로 삼각형 보드 렌더링 및 좌표계 검증
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 34 타일 삼각형 보드 화면 표시
  - [ ] 타일 클릭 시 타일 ID 정확히 반환
  - [ ] Up/Down 삼각형 시각적 구분
  - [ ] 화면 좌표 ↔ 타일 ID 변환 정확
  - [ ] 인접 타일 계산 검증 (수동 테스트)

작업:
  - [ ] npm create vite@latest + Phaser 설치
  - [ ] 삼각형 타일 렌더링 코드 작성
  - [ ] 좌표 변환 유틸리티 작성
  - [ ] 클릭 이벤트 테스트
```

> ⚠️ **이 Spike에서 막히면 프로젝트 재검토 필요**

---

### Epic 1: 프로젝트 셋업 🔴

> **목표**: 최소한의 개발 환경 구축
> **총 SP**: 10 (기존 8 + 테스트 인프라 2)

#### Story 1.1: 프로젝트 초기화 (간소화)
```yaml
ID: P1-E1-S1
제목: 프로젝트 초기화
설명: 단일 프로젝트 구조로 시작 (모노레포는 나중에)
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] package.json 설정
  - [ ] tsconfig.json 설정
  - [ ] .gitignore 설정
  - [ ] pnpm install 정상 동작
  - [ ] src/game-core/ 폴더 구조

작업:
  - [ ] Spike 코드를 프로젝트 구조로 정리
  - [ ] TypeScript 설정
  - [ ] ESLint, Prettier 설정
  - [ ] game-core 폴더 분리
```

#### Story 1.2: game-core 패키지 생성
```yaml
ID: P1-E1-S2
제목: game-core 패키지 생성
설명: 순수 게임 로직을 담을 패키지 생성
SP: 1
우선순위: 🔴

인수 조건:
  - [ ] packages/game-core/ 구조 생성
  - [ ] package.json 설정
  - [ ] 빌드 설정 (tsup 또는 vite lib mode)
  - [ ] 다른 패키지에서 import 가능

작업:
  - [ ] 패키지 디렉토리 생성
  - [ ] TypeScript 설정
  - [ ] 빌드 스크립트 설정
```

#### Story 1.3: web 앱 패키지 생성
```yaml
ID: P1-E1-S3
제목: web 앱 패키지 생성
설명: React + Vite 웹 앱 패키지 생성
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] apps/web/ 구조 생성
  - [ ] Vite + React + TypeScript 설정
  - [ ] TailwindCSS 설정
  - [ ] game-core 패키지 의존성 연결
  - [ ] pnpm dev로 개발 서버 실행

작업:
  - [ ] Vite 프로젝트 생성
  - [ ] TailwindCSS 설정
  - [ ] 워크스페이스 의존성 설정
```

#### Story 1.4: CI/CD 파이프라인 설정 (Phase 1 후반)
```yaml
ID: P1-E1-S4
제목: CI/CD 파이프라인 설정
설명: 첫 외부 플레이테스트 전에 설정
SP: 2
우선순위: 🟡  # 🔴에서 🟡로 변경

인수 조건:
  - [ ] PR 시 빌드/테스트 검증
  - [ ] main 브랜치 push 시 자동 배포
  - [ ] Cloudflare Pages 연동

작업:
  - [ ] .github/workflows/ci.yml 생성
  - [ ] .github/workflows/deploy.yml 생성
  - [ ] Cloudflare 설정
  - [ ] GitHub Secrets 설정

# NOTE: M4 완료 후, 외부 플레이테스트 전에 설정
```

#### Story 1.5: 개발 문서 정비
```yaml
ID: P1-E1-S5
제목: 개발 문서 정비
설명: README, CONTRIBUTING 등 개발 가이드 작성
SP: 1
우선순위: 🟡

인수 조건:
  - [ ] README.md (프로젝트 소개, 시작 방법)
  - [ ] CLAUDE.md (AI 어시스턴트 컨텍스트)

작업:
  - [ ] README 작성
  - [ ] 개발 환경 설정 가이드
```

#### Story 1.6: 테스트 인프라 구축 ⚡ NEW
```yaml
ID: P1-E1-S6
제목: 테스트 인프라 구축
설명: Vitest 설정 및 CI 연동
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] Vitest 설정 완료
  - [ ] 코드 커버리지 리포트 생성
  - [ ] pnpm test 명령어 동작
  - [ ] 테스트 실패 시 빌드 실패

작업:
  - [ ] vitest.config.ts 설정
  - [ ] 커버리지 설정 (c8/istanbul)
  - [ ] 샘플 테스트 작성
  - [ ] npm scripts 추가
```

---

### Epic 2: 보드 시스템 🔴

> **목표**: 삼각형 보드 렌더링 및 기물 배치
> **총 SP**: 17 (기존 13 + 4 재추정)

#### Story 2.1: 타입 시스템 정의
```yaml
ID: P1-E2-S1
제목: 게임 타입 시스템 정의
설명: 게임 상태, 기물, 보드 등 핵심 타입 정의
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] GameState 타입 정의
  - [ ] Piece, PieceStats 타입 정의
  - [ ] Board, Tile 타입 정의
  - [ ] Action 타입 정의

작업:
  - [ ] packages/game-core/src/types.ts 작성
  - [ ] Legacy types.ts 참조 및 정제
```

#### Story 2.2: BoardGraph 구현
```yaml
ID: P1-E2-S2
제목: BoardGraph 클래스 구현
설명: 삼각형 그리드 시스템 및 인접성 계산
SP: 5  # 3에서 5로 상향 (삼각형 좌표계 복잡성)
우선순위: 🔴

인수 조건:
  - [ ] 34 타일 생성 (30 메인 + 4 엣지)
  - [ ] 인접 타일 계산 (모든 34타일 검증)
  - [ ] 공격 방향별 타겟 타일 계산 (해/달/전선)
  - [ ] 경로 탐색 (BFS)
  - [ ] 단위 테스트 100% 통과

작업:
  - [ ] src/game-core/board-graph.ts 작성
  - [ ] Legacy BoardGraph.ts 정제 및 이식
  - [ ] 좌표 변환 유틸리티 (Spike에서 이식)
  - [ ] 테스트 케이스 작성 (모든 타일)
```

#### Story 2.3: Phaser SSR Safe 설정
```yaml
ID: P1-E2-S3
제목: Phaser SSR Safe 로딩 구현
설명: 서버 사이드에서 Phaser 없이 동작하도록 설정
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] useGameLoader 훅 구현
  - [ ] 서버 빌드 에러 없음
  - [ ] 클라이언트에서 Phaser 정상 로딩

작업:
  - [ ] TanStack Query 설정
  - [ ] useGameLoader 훅 작성
  - [ ] 빌드 테스트
```

#### Story 2.4: 보드 렌더링
```yaml
ID: P1-E2-S4
제목: 삼각형 보드 렌더링
설명: Phaser로 34 타일 삼각형 보드 시각화
SP: 5  # 3에서 5로 상향 (좌표계 변환 디버깅)
우선순위: 🔴

인수 조건:
  - [ ] 34 타일 화면 중앙에 정렬 표시
  - [ ] Up/Down 삼각형 시각적 구분 (색상 또는 경계선)
  - [ ] 디버그 모드에서 타일 ID 표시
  - [ ] 해상도 320px~2560px에서 보드가 화면 70-90% 차지
  - [ ] 종횡비 변화 시 타일 비율 왜곡 없음

작업:
  - [ ] MainScene.ts 작성
  - [ ] Board.ts 렌더링 클래스 작성
  - [ ] Tile.ts 타일 그래픽 작성
  - [ ] 반응형 스케일링 로직
```

#### Story 2.5: 타일 인터랙션
```yaml
ID: P1-E2-S5
제목: 타일 클릭 인터랙션
설명: 타일 클릭 시 선택 표시 및 이벤트 발생
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 타일 클릭 이벤트 처리
  - [ ] 선택된 타일 하이라이트
  - [ ] 클릭 좌표 → 타일 ID 변환

작업:
  - [ ] 클릭 이벤트 리스너
  - [ ] 하이라이트 그래픽
  - [ ] 좌표 변환 유틸리티
```

#### Story 2.6: 장수 렌더링 및 배치
```yaml
ID: P1-E2-S6
제목: 오호대장군 렌더링 및 초기 배치
설명: 10명 장수(관우, 장비, 조운, 황충, 마초 × 2팀)를 보드에 배치
SP: 2  # 1에서 2로 상향 (에셋 관리)
우선순위: 🔴

인수 조건:
  - [ ] 장수 스프라이트 렌더링 (관우, 장비, 조운, 황충, 마초)
  - [ ] 팀별 색상 구분 (Player A: 파랑, Player B: 빨강)
  - [ ] 초기 위치에 배치
  - [ ] placeholder 스프라이트 사용 가능

작업:
  - [ ] Piece.ts 스프라이트 클래스
  - [ ] 팀 색상 설정
  - [ ] 초기 배치 로직
  - [ ] 에셋 로딩/관리
```

---

### Epic 3: 전투 시스템 🔴

> **목표**: 이동, 공격, 교착/이탈 구현
> **총 SP**: 18 (기존 15 + 3 재추정)

#### Story 3.1: 게임 엔진 기반 구현
```yaml
ID: P1-E3-S1
제목: 게임 엔진 기반 구현
설명: 액션 적용, 상태 관리 핵심 로직
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] applyAction 함수 구현
  - [ ] validateAction 함수 구현
  - [ ] 불변 상태 업데이트
  - [ ] 단위 테스트 통과

작업:
  - [ ] packages/game-core/src/engine.ts 작성
  - [ ] Legacy engine.ts 정제 및 이식
  - [ ] 테스트 케이스 작성
```

#### Story 3.2: Zustand 스토어 구현
```yaml
ID: P1-E3-S2
제목: 게임 상태 Zustand 스토어
설명: 클라이언트 게임 상태 관리
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] gameStore 생성
  - [ ] 게임 초기화 액션
  - [ ] 액션 실행 액션
  - [ ] Phaser와 연동

작업:
  - [ ] apps/web/src/stores/gameStore.ts 작성
  - [ ] React-Phaser 이벤트 연결
```

#### Story 3.3: 이동 시스템 구현
```yaml
ID: P1-E3-S3
제목: 기물 이동 시스템
설명: 기물 선택 및 이동 실행
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 기물 클릭 시 선택
  - [ ] 이동 가능 타일 표시
  - [ ] 타일 클릭 시 이동 실행
  - [ ] 이동력 제한 적용

작업:
  - [ ] 기물 선택 로직
  - [ ] 이동 가능 영역 계산
  - [ ] 이동 애니메이션
  - [ ] 이동 실행 및 상태 업데이트
```

#### Story 3.4: 공격 시스템 구현
```yaml
ID: P1-E3-S4
제목: 해/달/전선 공격 시스템
설명: 방향별 공격 및 데미지 계산 (공격력 vs 공격력 비교)
SP: 5  # 3에서 5로 상향 (3방향 로직 복잡성)
우선순위: 🔴

인수 조건:
  - [ ] 공격 가능 대상 표시
  - [ ] 해/달/전선 방향 구분
  - [ ] 해/달 라인: 공격자 공격력 vs 수비자 공격력 비교 (방어력 개념 없음)
  - [ ] 전선 라인: 피해 1 + 교착 상태
  - [ ] 병력 0 시 전멸 상태 전환 (첫 번째: 복귀, 두 번째: 완전 퇴장)
  - [ ] 병력은 음수가 될 수 없음

작업:
  - [ ] 공격 대상 계산 로직
  - [ ] 데미지 계산 공식 구현 (Star 스탯 사용 안함)
  - [ ] 전멸/와해 상태 처리
  - [ ] 공격 시각 효과
```

#### Story 3.5: 교착/이탈 시스템
```yaml
ID: P1-E3-S5
제목: 교착 및 이탈 메커니즘
설명: 전선 공격 시 교착, 교착 상태에서 이동 선택 시 자동 이탈
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 전선 공격 시 피해 1 + 교착 상태 진입
  - [ ] 교착 상태 시각 표시
  - [ ] 교착 상태에서 [이동] 선택 시 자동 이탈 처리 (별도 이탈 액션 없음)
  - [ ] 이탈 시 이탈자만 피해 2
  - [ ] 병력 2 이하인 경우 이탈 즉시 전멸 처리

작업:
  - [ ] 교착 상태 관리
  - [ ] 이동 시 이탈 자동 처리 로직
  - [ ] 페널티 적용
```

#### Story 3.6: 액션 제한 시스템
```yaml
ID: P1-E3-S6
제목: 턴당 액션 제한
설명: 같은 기물 같은 액션 2회 제한
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 액션 히스토리 추적
  - [ ] 동일 액션 제한 검증
  - [ ] UI에 사용 가능 액션 표시

작업:
  - [ ] 액션 히스토리 상태
  - [ ] 검증 로직
  - [ ] UI 피드백
```

---

### Epic 4: 로컬 플레이 🔴

> **목표**: 2인 로컬 플레이 완성
> **총 SP**: 15 (기존 10 + 테스트 3 + 에셋 2)

#### Story 4.1: 턴 시스템
```yaml
ID: P1-E4-S1
제목: 턴 전환 시스템
설명: 2 액션 후 턴 전환
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 2 액션 소모 후 자동 턴 전환
  - [ ] 패스 액션으로 턴 종료
  - [ ] 현재 턴 플레이어 표시

작업:
  - [ ] 턴 전환 로직
  - [ ] 패스 액션 구현
  - [ ] 턴 표시 UI
```

#### Story 4.2: 승리 조건 체크
```yaml
ID: P1-E4-S2
제목: 승리 조건 판정
설명: 노크 3회(행동 소비 필요), 전멸, 와해 승리 체크
SP: 3  # 2에서 3으로 상향 (복귀 위치 로직)
우선순위: 🔴

인수 조건:
  - [ ] 끝 칸 도달 후 행동 1개 소비로 노크 (도달만으로는 노크 아님)
  - [ ] 행동력 소진 상태로 끝 칸 도달 시 노크 불가
  - [ ] 노크 카운트 증가 및 3회 시 승리 판정
  - [ ] 전멸 승리 체크 (상대 병력 전부 소멸)
  - [ ] 와해 승리 체크 (상대 장수 모두 완전 퇴장, 일시 OUT 제외)
  - [ ] 노크 후 복귀 위치 계산 (아군 점유 시 대체 위치)

작업:
  - [ ] 노크 행동 로직 (끝 칸 도달 + 행동 소비)
  - [ ] 승리 조건 체크 함수 (노크/전멸/와해)
  - [ ] 노크 후 기물 복귀 (복귀 위치 로직 포함)
  - [ ] 전멸/와해 용어 구분 처리
```

#### Story 4.3: 게임 UI 패널
```yaml
ID: P1-E4-S3
제목: 게임 정보 UI
설명: 상태, 턴, 기물 정보 표시
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 현재 턴/플레이어 표시
  - [ ] 남은 액션 수 표시
  - [ ] 노크 카운트 표시
  - [ ] 선택된 기물 정보

작업:
  - [ ] TurnIndicator 컴포넌트
  - [ ] ActionCounter 컴포넌트
  - [ ] KnockCounter 컴포넌트
  - [ ] PieceInfo 컴포넌트
```

#### Story 4.4: 게임 플로우
```yaml
ID: P1-E4-S4
제목: 게임 시작/종료 플로우
설명: 게임 초기화, 승리 화면, 재시작
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 게임 시작 화면
  - [ ] 승리/패배 결과 화면
  - [ ] 재시작 기능
  - [ ] 메인 메뉴 복귀

작업:
  - [ ] StartScreen 컴포넌트
  - [ ] ResultScreen 컴포넌트
  - [ ] 게임 리셋 로직
```

#### Story 4.5: 폴리시 및 피드백
```yaml
ID: P1-E4-S5
제목: UX 폴리시
설명: 애니메이션, 효과음 없는 시각 피드백
SP: 2
우선순위: 🟡

인수 조건:
  - [ ] 이동 애니메이션 부드럽게
  - [ ] 공격 시 시각 효과
  - [ ] 유효하지 않은 액션 피드백
  - [ ] 터치 반응성 개선

작업:
  - [ ] Tween 애니메이션 조정
  - [ ] 시각 효과 추가
  - [ ] 에러 메시지 표시
```

#### Story 4.6: 통합 테스트 작성 ⚡ NEW
```yaml
ID: P1-E4-S6
제목: 게임 플로우 통합 테스트
설명: 전체 게임 플로우 E2E 테스트
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 전체 게임 플로우 테스트 (시작→노크 승리)
  - [ ] 섬멸 승리 시나리오 테스트
  - [ ] 교착/이탈 시나리오 테스트
  - [ ] 엣지 케이스 테스트 (규칙 문서 기반)
  - [ ] 코드 커버리지 80% 이상 (game-core)

작업:
  - [ ] 게임 플로우 E2E 테스트
  - [ ] 전투 시스템 통합 테스트
  - [ ] 엣지 케이스 테스트
  - [ ] 커버리지 확인
```

#### Story 4.7: 에셋 파이프라인 ⚡ NEW
```yaml
ID: P1-E4-S7
제목: 에셋 조달 및 관리
설명: 장수 스프라이트 에셋 준비
SP: 2
우선순위: 🟡

인수 조건:
  - [ ] 5종 장수 스프라이트 (placeholder 또는 실제)
  - [ ] 2팀 색상 구분 가능
  - [ ] 에셋 로딩 시스템

작업:
  - [ ] placeholder 스프라이트 제작 또는 조달
  - [ ] 텍스처 아틀라스 생성
  - [ ] 에셋 로딩 유틸리티
```

---

## Phase 2: Online Demo

### Epic 5: UI 페이지 시스템 🔴

> **목표**: 홈, 로비, 대기실, 결과 화면 구현
> **총 SP**: 18
> **참조**: `06-ui-page-flow.md`

#### Story 5.1: 라우팅 및 레이아웃
```yaml
ID: P2-E5-S1
제목: 페이지 라우팅 및 공통 레이아웃
설명: TanStack Router 설정 및 공통 레이아웃 구현
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] TanStack Router 설정
  - [ ] 페이지별 라우트 정의 (/, /lobby, /room/:id, /game/:id, /result/:id)
  - [ ] 공통 헤더/푸터 레이아웃
  - [ ] 404 페이지

작업:
  - [ ] router.ts 설정
  - [ ] Layout 컴포넌트
  - [ ] 페이지 컴포넌트 스캐폴딩
```

#### Story 5.2: 홈 화면
```yaml
ID: P2-E5-S2
제목: 홈 화면 (로그인/게스트)
설명: 첫 진입점, 게스트 입장 및 로그인 UI
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 게임 타이틀 및 테마 표시
  - [ ] 게스트 입장 버튼 (닉네임 자동 생성)
  - [ ] 로그인 버튼 (Phase 2: 기본 폼)
  - [ ] 소셜 로그인 버튼 UI (Phase 3에서 연동)
  - [ ] 설정/도움말 버튼

작업:
  - [ ] HomePage.tsx 컴포넌트
  - [ ] LoginModal 컴포넌트
  - [ ] GuestButton 컴포넌트
  - [ ] useAuth 훅 (기본)
```

#### Story 5.3: 로비 화면
```yaml
ID: P2-E5-S3
제목: 로비 (방 목록/빠른 입장)
설명: 방 목록 표시, 빠른 입장, 방 생성 기능
SP: 4
우선순위: 🔴

인수 조건:
  - [ ] 방 목록 테이블 (이름, 호스트, 상태, 인원)
  - [ ] 빠른 입장 버튼 (자동 매칭)
  - [ ] 방 만들기 버튼
  - [ ] 실시간 방 목록 갱신
  - [ ] 접속자/게임 수 표시

작업:
  - [ ] LobbyPage.tsx 컴포넌트
  - [ ] RoomList 컴포넌트
  - [ ] RoomCard 컴포넌트
  - [ ] QuickMatchButton 컴포넌트
  - [ ] useLobby 훅
```

#### Story 5.4: 방 설정 모달
```yaml
ID: P2-E5-S4
제목: 방 설정 (생성 옵션)
설명: 방 생성 시 옵션 설정 모달
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 방 이름 입력
  - [ ] 턴 시간 제한 선택 (없음/60초/90초/120초)
  - [ ] 비밀번호 설정 (선택)
  - [ ] 방 만들기 버튼

작업:
  - [ ] RoomSettingsModal 컴포넌트
  - [ ] 폼 유효성 검증
  - [ ] useCreateRoom 훅
```

#### Story 5.5: 대기실 화면
```yaml
ID: P2-E5-S5
제목: 대기실 (준비/채팅)
설명: 플레이어 준비 상태 및 채팅 기능
SP: 4
우선순위: 🔴

인수 조건:
  - [ ] 플레이어 카드 2개 (닉네임, 레이팅, 준비 상태)
  - [ ] 준비 완료/취소 토글 버튼
  - [ ] 실시간 채팅 (메시지 입력/표시)
  - [ ] 나가기 버튼
  - [ ] 모두 준비 시 게임 시작

작업:
  - [ ] WaitingRoomPage.tsx 컴포넌트
  - [ ] PlayerCard 컴포넌트
  - [ ] ReadyButton 컴포넌트
  - [ ] ChatBox 컴포넌트
  - [ ] useRoom 훅
```

#### Story 5.6: 결과 화면 개선
```yaml
ID: P2-E5-S6
제목: 결과 화면 (통계/재대결)
설명: 게임 결과 상세 표시 및 다음 행동 선택
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 승리/패배 표시 (승리 유형 포함)
  - [ ] 게임 통계 (턴 수, 노크, 처치, 데미지)
  - [ ] 재대결 버튼 (상대 동의 필요)
  - [ ] 로비로 버튼
  - [ ] 결과 화면 채팅

작업:
  - [ ] ResultPage.tsx 컴포넌트 개선
  - [ ] WinnerDisplay 컴포넌트
  - [ ] GameStats 컴포넌트
  - [ ] RematchButton 컴포넌트
```

---

### Epic 6: 게임 서버 🔴

> **목표**: Colyseus 기반 실시간 게임 서버
> **총 SP**: 11

#### Story 6.1: Colyseus 서버 설정
```yaml
ID: P2-E6-S1
제목: Colyseus 서버 초기화
설명: 게임 서버 프로젝트 설정 및 기본 구조
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] apps/game-server 패키지 생성
  - [ ] Colyseus + Express 설정
  - [ ] 개발 서버 실행 (포트 2567)
  - [ ] Docker 설정

작업:
  - [ ] 패키지 초기화
  - [ ] index.ts 진입점
  - [ ] Dockerfile 작성
```

#### Story 6.2: GameRoom 구현
```yaml
ID: P2-E6-S2
제목: GameRoom 클래스 구현
설명: 게임 룸 생성, 입장, 메시지 처리
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 룸 생성/입장/퇴장 처리
  - [ ] 메시지 라우팅 (action, chat)
  - [ ] 준비 상태 관리
  - [ ] 게임 시작 트리거

작업:
  - [ ] GameRoom.ts 클래스
  - [ ] 메시지 핸들러
  - [ ] 상태 브로드캐스트
```

#### Story 6.3: GameState 스키마
```yaml
ID: P2-E6-S3
제목: Colyseus 상태 스키마
설명: 동기화를 위한 게임 상태 스키마 정의
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] GameState 스키마 (Colyseus Schema)
  - [ ] Player 스키마
  - [ ] Piece 스키마
  - [ ] game-core 타입과 매핑

작업:
  - [ ] schemas/GameState.ts
  - [ ] 타입 변환 유틸리티
```

#### Story 6.4: 서버 권위적 검증
```yaml
ID: P2-E6-S4
제목: 서버 측 액션 검증
설명: 클라이언트 액션을 서버에서 검증
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] game-core 엔진을 서버에서 실행
  - [ ] 클라이언트 액션 검증
  - [ ] 유효하지 않은 액션 거부
  - [ ] 검증된 상태만 브로드캐스트

작업:
  - [ ] GameLogic.ts 서버 래퍼
  - [ ] 액션 검증 로직
  - [ ] 에러 응답 처리
```

---

### Epic 7: 매칭 시스템 🔴

> **목표**: 방 목록, 빠른 매칭, 룸 관리
> **총 SP**: 8

#### Story 7.1: 방 목록 API
```yaml
ID: P2-E7-S1
제목: 방 목록 조회/관리 API
설명: 현재 열린 방 목록 조회 및 관리
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 방 목록 조회 API
  - [ ] 방 생성 API
  - [ ] 방 입장 API
  - [ ] 실시간 목록 업데이트 (WebSocket)

작업:
  - [ ] LobbyRoom 클래스
  - [ ] 방 목록 브로드캐스트
  - [ ] 클라이언트 연동
```

#### Story 7.2: 빠른 매칭
```yaml
ID: P2-E7-S2
제목: 빠른 매칭 시스템
설명: 자동으로 상대를 찾아 매칭
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 매칭 큐 관리
  - [ ] 2명 매칭 시 자동 룸 생성
  - [ ] 매칭 대기 상태 표시
  - [ ] 매칭 취소 기능

작업:
  - [ ] MatchmakingService 클래스
  - [ ] 큐 관리 로직
  - [ ] 타임아웃 처리
```

#### Story 7.3: 연결 관리
```yaml
ID: P2-E7-S3
제목: 연결 상태 관리
설명: 연결 끊김, 재연결, 타임아웃 처리
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 연결 끊김 감지
  - [ ] 재연결 허용 (30초 내)
  - [ ] 타임아웃 시 패배 처리
  - [ ] 상대에게 상태 알림

작업:
  - [ ] 연결 상태 추적
  - [ ] 재연결 토큰 관리
  - [ ] 타임아웃 로직
```

---

### Epic 8: 온라인 플레이 🔴

> **목표**: 실시간 게임 동기화
> **총 SP**: 8

#### Story 8.1: 실시간 동기화
```yaml
ID: P2-E8-S1
제목: 게임 상태 실시간 동기화
설명: Colyseus 상태 동기화로 게임 진행
SP: 3
우선순위: 🔴

인수 조건:
  - [ ] 클라이언트 → 서버 액션 전송
  - [ ] 서버 → 클라이언트 상태 브로드캐스트
  - [ ] 상태 변경 시 UI 자동 업데이트
  - [ ] 지연 100ms 이내

작업:
  - [ ] useGameSync 훅
  - [ ] Colyseus 클라이언트 연동
  - [ ] 상태 리스너 설정
```

#### Story 8.2: 턴 타이머
```yaml
ID: P2-E8-S2
제목: 턴 시간 제한
설명: 턴 타이머 및 자동 패스 처리
SP: 2
우선순위: 🔴

인수 조건:
  - [ ] 서버 측 타이머 관리
  - [ ] 클라이언트 타이머 표시
  - [ ] 시간 초과 시 자동 패스
  - [ ] 남은 시간 동기화

작업:
  - [ ] 서버 타이머 로직
  - [ ] TurnTimer 컴포넌트
  - [ ] 자동 패스 액션
```

#### Story 8.3: 인게임 채팅
```yaml
ID: P2-E8-S3
제목: 게임 중 채팅
설명: 게임 진행 중 실시간 채팅
SP: 3
우선순위: 🟡

인수 조건:
  - [ ] 채팅 메시지 전송/수신
  - [ ] 채팅 UI (접기/펼치기)
  - [ ] 빠른 메시지 (GG, 잘했어요 등)
  - [ ] 채팅 기록 표시

작업:
  - [ ] GameChat 컴포넌트
  - [ ] 채팅 메시지 핸들러
  - [ ] 빠른 메시지 버튼
```

---

## Phase 3: Full Game (요약)

### Epic 9: 책략 시스템 🟡

> **참조**: `/docs/tatic.md` - SSOT 책략 상세 명세

**Phase 1/2에서의 준비**:
- [모의] 액션 UI 슬롯만 표시 (효과 없음)
- 플레이어가 향후 책략 시스템이 들어올 자리를 이해할 수 있게 하는 수준

**Phase 3에서 전체 구현**:
- Story 9.1: 책략 데이터 구조 및 덱 빌딩 시스템 (SP: 3)
- Story 9.2: 현장용 책략 10개 구현 (SP: 8)
  - 일격, 불괴, 보병장력, 돌파, 도발, 고오급 당근, 충차, 연노, 역습, 황충
- Story 9.3: 사무용 책략 10개 구현 (SP: 8)
  - 위보, 모병, 매복, 기만, 화계, 토벽, 망루, 함정, 화타, 투석
- Story 9.4: 책략 선택 UI 및 [모의] 액션 연동 (SP: 3)
- Story 9.5: 설치물 상호작용 규칙 구현 (SP: 3)
- Story 9.6: 보급 시스템 상세 구현 (SP: 2)

### Epic 10: 계정/랭킹 🟡
- Story 10.1: 소셜 로그인 (네이버/구글/카카오) (SP: 5)
- Story 10.2: ELO 레이팅 시스템 (SP: 3)
- Story 10.3: 리더보드 UI (SP: 3)
- Story 10.4: 프로필 페이지 (SP: 2)

### Epic 11: 출시 준비 🟡
- Story 11.1: 튜토리얼 (SP: 5)
- Story 11.2: 리플레이 시스템 (SP: 5)
- Story 11.3: 모니터링/분석 (SP: 3)
- Story 11.4: 관전 모드 (SP: 3)

---

## 백로그 요약 (수정됨)

### Phase 1 총계 (Local Demo)

| Epic | 스토리 수 | 총 SP | 변경 |
|------|----------|-------|------|
| Epic 0: 기술 검증 (Spike) | 1 | 3 | ⚡ NEW |
| Epic 1: 프로젝트 셋업 | 6 | 10 | +2 (테스트 인프라) |
| Epic 2: 보드 시스템 | 6 | 17 | +4 (좌표계 복잡성) |
| Epic 3: 전투 시스템 | 6 | 18 | +3 (3방향 공격) |
| Epic 4: 로컬 플레이 | 7 | 15 | +5 (테스트, 에셋) |
| **합계** | **26** | **63** | **+17** |

### Phase 2 총계 (Online Demo)

| Epic | 스토리 수 | 총 SP | 변경 |
|------|----------|-------|------|
| Epic 5: UI 페이지 시스템 | 6 | 18 | - |
| Epic 6: 게임 서버 | 5 | 14 | +3 (서버 테스트) |
| Epic 7: 매칭 시스템 | 3 | 8 | - |
| Epic 8: 온라인 플레이 | 3 | 8 | - |
| **합계** | **17** | **48** | **+3** |

### Phase 3 총계 (Full Game)

| Epic | 스토리 수 | 총 SP | 변경 |
|------|----------|-------|------|
| Epic 9: 책략 시스템 | 6 | 27 | +7 (SSOT 기반 상세화) |
| Epic 10: 계정/랭킹 | 4 | 13 | - |
| Epic 11: 출시 준비 | 4 | 16 | - |
| **합계** | **14** | **56** | **+7** |

### 전체 총계 (재추정)

| Phase | 스토리 수 | 총 SP | 예상 기간 |
|-------|----------|-------|----------|
| Phase 1 | 26 | **63** | **6주** |
| Phase 2 | 17 | **48** | **5주** |
| Phase 3 | 14 | **56** | **6주** |
| **전체** | **57** | **167** | **17주** |

### 예상 일정 (재추정)

- 1 SP = 반나절 (4시간)
- **Phase 1**: 63 SP ≈ 31일 → **6주** (테스트 + 버퍼 포함)
- **Phase 2**: 48 SP ≈ 24일 → **5주** (서버 테스트 포함)
- Phase 3: 49 SP ≈ 24일 → **5주** (버퍼 포함)

> ⚠️ **재추정 사유**:
> - 삼각형 좌표계 작업 과소평가 보정
> - 테스트 스토리 추가 (테스트 인프라, 통합 테스트, 서버 테스트)
> - 에셋 파이프라인 작업 추가

---

*이 백로그는 Max (Scrum Master)가 BMAD Party Mode 토론을 기반으로 작성했습니다.*
*UI Page Flow는 `06-ui-page-flow.md` 문서를 참조하세요.*
*책략 시스템 상세는 SSOT `/docs/tatic.md` 문서를 참조하세요.*
*SSOT 정합성 점검 반영: 2026-02-02*
