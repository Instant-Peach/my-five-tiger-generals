# HUD 기획자 결정 정리서

> 작성일: 2026-02-15
> 작성 근거: `docs/analysis/hud.md` (HUD 개선 보고서) + 기획자 피드백 (2026-02-15)
> 현재 브랜치: `dev/trial-2`

---

## 해결 완료 항목

| 항목 | 상태 | 조치 내용 |
|------|------|----------|
| 행동력 2 vs 3 | **해결** | 3으로 확정, 규칙 문서 수정 완료 |
| 병력 표시 (star vs star x 2) | **해결** | `TROOP_MULTIPLIER=2`, `getMaxTroops()` 도입 완료 |
| 교전(Engagement) 로직 | **해결** | `GeneralStatus`에 `engaged` 추가, 이탈 로직(피해 2) 구현 완료 |

---

## D1. 레이아웃 구조 -- 결정 완료

**결정: A (사이드바 유지)**

- 목업은 **모바일 뷰** 기준이었음
- PC는 현행 사이드바 레이아웃 유지
- 모바일 반응형에서 세부 위치 조절 시 목업 참고

---

## D2. 장수 패널 -- 결정 완료 (대폭 확장)

**결정: 양측 10명 장수를 우측 패널에 전체 표시**

### PC 우측 패널 레이아웃 (위 → 아래)

```
┌─────────────────────────┐
│ 적(P2) 상태 요약         │
├─────────────────────────┤
│ 적 장수 5명 초상화 행     │  ← 초상화 + 이름 + 목숨(●●)
│ [관우][장비][조운][황충][마초] │  ← 클릭 시 상세 정보 표시
├─────────────────────────┤
│                         │
│  선택된 장수 상세 정보     │  ← 보드 클릭 OR 초상화 클릭
│                         │
│  [영구 값]               │
│   - 능력치 (별/해/달/발)  │
│   - 출전 상태            │
│   - 목숨 (●● / ●○ / ○○) │
│                         │
│  [임시 값]               │
│   - 현재 병력 / 최대 병력  │
│   - 교전 상태            │
│   - 현재 위치            │
│                         │
├─────────────────────────┤
│ 나(P1) 장수 5명 초상화 행  │  ← 초상화 + 이름 + 목숨(●●)
│ [관우][장비][조운][황충][마초] │  ← 클릭 시 상세 정보 표시
├─────────────────────────┤
│ 나(P1) 상태 요약          │
└─────────────────────────┘
```

### 세부 결정 사항

**D2-1. 초상화 축소 상태**: 이름 + 목숨(●●)만 표시. 상세 선택 시 모든 스탯 표시.

**D2-2. 목숨 시스템**:
- 점등된 원 2개(●●)로 표시
- 1차 OUT → 하나 소등(●○), 복귀 가능
- 2차 OUT → 둘 다 소등(○○), 완전 퇴장, **어둡게 표시**
- **Phase 1에서 구현** (General에 `livesRemaining` 필드 추가 필요)

**D2-3. 인터랙션**:
- 초상화 클릭 → 상세 정보 표시 + **출전 중이면 보드에서도 선택됨**
- 보드에서 장수 클릭 → 상세 정보도 연동
- 양방향 선택 지원

**D2-4. 초상화 에셋**: 준비됨. 이미지 경로 지정 시 적용 예정.

**D2-5. 적 장수 정보 공개 범위**:
- 현재 정보는 **모두 공개** (적 초상화 클릭 시 상세 정보 열람 가능)
- 추후 책략 시스템에 의해 비공개 정보 추가될 예정 (Phase 2+)

---

## D3. 액션 버튼 -- 결정 완료 (2계층 분리)

**결정: 플레이어 액션과 장수 액션을 분리**

### 계층 1: 플레이어 액션 (하단 바)

게임 전체에 대한 플레이어의 결정.

```
┌────────────────────────────────────────────────┐
│ [설정] [턴 N] [타이머 60s] [행동 ●●○]  │  [항복] [책략] [턴 종료] │
│          좌측: 상태 정보 그룹           │  우측: 플레이어 액션 그룹  │
└────────────────────────────────────────────────┘
```

- **좌측 그룹**: 설정, 턴 번호, 타이머, 행동 카운터
- **우측 그룹**: 항복, 책략, 턴 종료

**D3-1. 턴 종료**: **필요함**. 행동력이 남았을 때 의도적 턴 넘기기 용도.

**D3-3. 설정**: 하단 바 좌측에 유지. 추후 위치 변경 가능.

**D3-4. 찻잔 아이콘**: 행동력 표시 아이디어 (찻잔 위 곡선 3개 = 행동력). 찻잔 자체가 턴 넘기기 역할. 관우의 "차가 식기 전에" 비유. **지금은 미적용, 추후 참고.**

### 계층 2: 장수 액션 (보드 내 팝업, Phaser 내부 UI)

선택한 장수가 수행할 행동. **장수를 선택하면 장수 근처에 버튼이 출현, 해제 시 사라짐.**

```
        [이동]
  장수 ◆ [공격]
        [노크]  ← 조건 충족 시에만 표시
```

**각 버튼 동작:**

| 버튼 | 활성 조건 | 클릭 시 동작 |
|------|----------|------------|
| [이동] | 이동 가능한 타일 존재 | 이동 모드 진입 → 타일 클릭 → 미리보기 → 확정 버튼 → 이동 실행 |
| [이동] (교전 중) | 이동 가능하지만 교전 상태 | 클릭 시 **"교전 회피" 경고 모달** (피해량 예상 표시) → 확인 후 이탈 이동 |
| [공격] | 공격 대상 존재 | 공격 모드 진입 → 대상 클릭 → 공격 실행 |
| [공격] (비활성) | 공격 대상 없음 | 비활성 상태로 표시 |
| [노크] | 적진 도달 + 행동력 잔여 | 노크 실행 |

**D3-2. 노크 버튼**: 장수 액션이므로 장수 근처 팝업에 표시. 조건 충족 시에만 나타남.

**구현 방식: Phaser 내부 UI** (게임 느낌 자연스러움, 접근성은 별도 처리)

---

## D4. 노크 카운트 배치 -- 결정 완료

**결정: Phaser 내부 UI로 구현**

- 노크는 장수 액션이므로, 장수 선택 시 장수 근처에 노크 카운트 표시
- 3곳 중복 제거
- Phaser 내부 UI 방식

---

## D5. 턴/타이머/행동 카운터 -- 결정 완료

**결정: 하단 바 좌측 그룹으로 이동**

- 우측 패널에서 제거 → **하단 바 좌측**으로 이동
- 우측 패널은 **전체 상황 요약**(양측 장수 현황)에 집중
- 하단 바는 **상태 정보 + 플레이어 액션**에 집중

레이아웃:
```
┌──────────────────────────────────────────┐
│ [설정] [턴 3] [⏱ 45s] [●●○]  │  [항복] [책략] [턴 종료] │
└──────────────────────────────────────────┘
```

---

## D6. 교전(Engagement) UI -- 결정 완료

**결정:**

| 항목 | 결정 |
|------|------|
| D6-1 교전 인디케이터 | 보드 위 **두 장수 말에 인디케이터** 표시 (구체적 형태는 구현 시 결정) |
| D6-2 교전 연결선 | **불필요**. 인디케이터만으로 충분 |
| D6-3 이탈 비용 안내 | 장수 액션 [이동] 클릭 시 **"교전 회피" 경고 모달**에서 피해량 예상 표시 |
| D6-4 장수 패널 교전 표시 | 우측 패널 초상화 영역에 **교전 상태 배지** 표시 + 상세 정보에서 반드시 표시 |

---

## 구현 영향 분석

기획자 결정에 따라 도출된 **신규 구현 과제**:

### Phase 1 필수

| # | 과제 | 규모 | 영향 범위 |
|---|------|------|----------|
| W1 | **목숨 시스템** (livesRemaining 필드 + 2차 OUT = 완전 퇴장) | M | `generals/types.ts`, `combat/attack.ts`, `state/`, tests |
| W2 | **우측 패널 재설계**: 양측 10명 장수 초상화 + 상세 정보 | L | `SidePanel.tsx` 전면 재작업 또는 신규 컴포넌트 |
| W3 | **하단 바 재배치**: 좌측(상태정보) / 우측(플레이어 액션) 분리 | S | `BottomActionBar.tsx` |
| W4 | **장수 액션 팝업** (Phaser 내부): [이동][공격][노크] 버튼 | L | `GameScene.ts`, 신규 Phaser UI 클래스 |
| W5 | **이동 모드 UX**: 타일 클릭 → 미리보기 → 확정 플로우 | M | `GameScene.ts`, movement 관련 |
| W6 | **교전 회피 경고 모달**: 이동 모드 진입 시 피해량 경고 | S | Phaser UI 또는 React 모달 |
| W7 | **교전 인디케이터**: 보드 위 장수 말에 표시 | S | `GeneralRenderer.ts` |
| W8 | **우측 패널 교전 배지**: 초상화 영역 + 상세 정보 | S | 신규 SidePanel 컴포넌트 |

### Phase 2 이후

| # | 과제 | 비고 |
|---|------|------|
| F1 | 모바일 반응형 레이아웃 (목업 참고) | 우측 패널 → 하단 이동, 장수 액션은 보드 내 유지 |
| F2 | 장수 초상화 이미지 에셋 적용 | 에셋 준비됨, 경로 지정 필요 |
| F3 | 찻잔 행동력 UI (김 3개 = 행동력) | 기획 아이디어 보존, 추후 적용 |
| F4 | 책략 시스템에 의한 적 정보 비공개 처리 | 책략 시스템 구현 후 |

---

## 전체 레이아웃 확정안 (PC)

```
┌────────────────────────────┬─────────────────────┐
│                            │ [적(P2) 상태 요약]    │
│                            ├─────────────────────┤
│                            │ 적 장수 5명 초상화    │
│                            │ [관][장][조][황][마]  │
│                            ├─────────────────────┤
│       게임 보드 (Phaser)     │                     │
│                            │  선택된 장수          │
│   장수 선택 시:              │  상세 정보           │
│   근처에 [이동][공격][노크]   │  (영구 값 + 임시 값)  │
│   팝업 표시 (Phaser 내부)    │                     │
│                            ├─────────────────────┤
│                            │ 내 장수 5명 초상화    │
│                            │ [관][장][조][황][마]  │
│                            ├─────────────────────┤
│                            │ [나(P1) 상태 요약]    │
├────────────────────────────┴─────────────────────┤
│ [설정][턴 3][⏱ 45s][●●○]      [항복][책략][턴 종료] │
│      좌측: 상태 정보              우측: 플레이어 액션  │
└──────────────────────────────────────────────────┘
```
